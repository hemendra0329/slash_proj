2025-02-09 20:59:05 jdbc[26]: exception
org.h2.jdbc.JdbcSQLSyntaxErrorException: Values of types "TIMESTAMP" and "NUMERIC(16, 10)" are not comparable; SQL statement:
SELECT DATE_TRUNC('quarter', "PUBLIC"."ORDERS"."CREATED_AT") AS "CREATED_AT", SUM("PUBLIC"."ORDERS"."TOTAL") AS "sum" FROM "PUBLIC"."ORDERS" LEFT JOIN "PUBLIC"."PRODUCTS" AS "PRODUCTS__via__PRODUCT_ID" ON "PUBLIC"."ORDERS"."PRODUCT_ID" = "PRODUCTS__via__PRODUCT_ID"."ID" WHERE (("PUBLIC"."ORDERS"."CREATED_AT" <> 150057.1074961184) OR ("PUBLIC"."ORDERS"."CREATED_AT" IS NULL)) AND (("PRODUCTS__via__PRODUCT_ID"."CATEGORY" = ?) OR ("PRODUCTS__via__PRODUCT_ID"."CATEGORY" = ?) OR ("PRODUCTS__via__PRODUCT_ID"."CATEGORY" = ?) OR ("PRODUCTS__via__PRODUCT_ID"."CATEGORY" = ?)) AND ("PUBLIC"."ORDERS"."CREATED_AT" >= DATE_TRUNC('quarter', DATEADD('month', CAST(-12 * 3 AS integer), NOW()))) AND ("PUBLIC"."ORDERS"."CREATED_AT" < DATE_TRUNC('quarter', DATEADD('month', CAST(1 * 3 AS integer), NOW()))) GROUP BY DATE_TRUNC('quarter', "PUBLIC"."ORDERS"."CREATED_AT") ORDER BY DATE_TRUNC('quarter', "PUBLIC"."ORDERS"."CREATED_AT") ASC [90110-214]
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:632)
	at org.h2.message.DbException.getJdbcSQLException(DbException.java:477)
	at org.h2.message.DbException.get(DbException.java:223)
	at org.h2.value.TypeInfo.checkComparable(TypeInfo.java:766)
	at org.h2.expression.condition.Comparison.optimize(Comparison.java:159)
	at org.h2.expression.condition.ConditionAndOr.optimize(ConditionAndOr.java:136)
	at org.h2.expression.condition.ConditionAndOr.optimize(ConditionAndOr.java:136)
	at org.h2.expression.condition.ConditionAndOrN.optimize(ConditionAndOrN.java:168)
	at org.h2.expression.Expression.optimizeCondition(Expression.java:148)
	at org.h2.command.query.Select.prepareExpressions(Select.java:1177)
	at org.h2.command.query.Query.prepare(Query.java:218)
	at org.h2.command.Parser.prepareCommand(Parser.java:575)
	at org.h2.engine.SessionLocal.prepareLocal(SessionLocal.java:631)
	at org.h2.engine.SessionLocal.prepareCommand(SessionLocal.java:554)
	at org.h2.jdbc.JdbcConnection.prepareCommand(JdbcConnection.java:1116)
	at org.h2.jdbc.JdbcPreparedStatement.<init>(JdbcPreparedStatement.java:92)
	at org.h2.jdbc.JdbcConnection.prepareStatement(JdbcConnection.java:1015)
	at com.mchange.v2.c3p0.impl.NewProxyConnection.prepareStatement(NewProxyConnection.java:677)
	at metabase.driver.sql_jdbc.execute$fn__87683.invokeStatic(execute.clj:479)
	at metabase.driver.sql_jdbc.execute$fn__87683.invoke(execute.clj:477)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.driver.sql_jdbc.execute$prepared_statement_STAR_$fn__87752.invoke(execute.clj:539)
	at metabase.driver.sql_jdbc.execute$prepared_statement_STAR_.invokeStatic(execute.clj:538)
	at metabase.driver.sql_jdbc.execute$prepared_statement_STAR_.invoke(execute.clj:535)
	at metabase.driver.sql_jdbc.execute$statement_or_prepared_statement.invokeStatic(execute.clj:561)
	at metabase.driver.sql_jdbc.execute$statement_or_prepared_statement.invoke(execute.clj:556)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query$fn__87832.invoke(execute.clj:712)
	at metabase.driver.h2$fn__93262$fn__93264.invoke(h2.clj:543)
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection87608__87609.invokeStatic(execute.clj:338)
	at metabase.driver.sql_jdbc.execute$do_with_resolved_connection87608__87609.invoke(execute.clj:321)
	at metabase.driver.h2$fn__93262.invokeStatic(h2.clj:534)
	at metabase.driver.h2$fn__93262.invoke(h2.clj:530)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:707)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:704)
	at metabase.driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:693)
	at metabase.driver.sql_jdbc$fn__116057.invokeStatic(sql_jdbc.clj:79)
	at metabase.driver.sql_jdbc$fn__116057.invoke(sql_jdbc.clj:77)
	at metabase.driver.h2$fn__93101.invokeStatic(h2.clj:271)
	at metabase.driver.h2$fn__93101.invoke(h2.clj:267)
	at clojure.lang.MultiFn.invoke(MultiFn.java:244)
	at metabase.query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:52)
	at metabase.query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:39)
	at metabase.query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:102)
	at metabase.query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:95)
	at metabase.query_processor.execute$run.invokeStatic(execute.clj:62)
	at metabase.query_processor.execute$run.invoke(execute.clj:56)
	at metabase.query_processor.middleware.update_used_cards$update_used_cards_BANG_76007__76008$fn__76009.invoke(update_used_cards.clj:60)
	at metabase.query_processor.execute$add_native_form_to_result_metadata$fn__76024.invoke(execute.clj:25)
	at metabase.query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__76030.invoke(execute.clj:36)
	at metabase.query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___75980.invoke(cache.clj:241)
	at metabase.query_processor.middleware.permissions$check_query_permissions$fn__72652.invoke(permissions.clj:148)
	at metabase.query_processor.middleware.enterprise$check_download_permissions_middleware$fn__73373.invoke(enterprise.clj:51)
	at metabase.query_processor.middleware.enterprise$maybe_apply_column_level_perms_check_middleware$fn__73383.invoke(enterprise.clj:64)
	at metabase.query_processor.execute$execute76057__76058$fn__76059.invoke(execute.clj:94)
	at metabase.query_processor.setup$do_with_qp_setup73927__73928.invokeStatic(setup.clj:225)
	at metabase.query_processor.setup$do_with_qp_setup73927__73928.invoke(setup.clj:216)
	at metabase.query_processor.execute$execute76057__76058.invokeStatic(execute.clj:93)
	at metabase.query_processor.execute$execute76057__76058.invoke(execute.clj:89)
	at metabase.query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:49)
	at metabase.query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:44)
	at metabase.query_processor.middleware.enterprise$fn__73400$handle_audit_app_internal_queries__73401$fn__73403.invoke(enterprise.clj:96)
	at metabase.query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73411.invoke(enterprise.clj:103)
	at metabase.query_processor.middleware.process_userland_query$process_userland_query_middleware78670__78671$fn__78672.invoke(process_userland_query.clj:217)
	at metabase.query_processor.middleware.catch_exceptions$catch_exceptions78735__78736$fn__78737.invoke(catch_exceptions.clj:132)
	at metabase.query_processor$process_query78776__78777$fn__78778.invoke(query_processor.clj:80)
	at metabase.query_processor.setup$do_with_canceled_chan73922__73923$fn__73924.invoke(setup.clj:187)
	at metabase.query_processor.setup$do_with_database_local_settings73915__73916$fn__73917.invoke(setup.clj:181)
	at metabase.query_processor.setup$do_with_driver73908__73909$fn__73910$fn__73911.invoke(setup.clj:166)
	at metabase.driver$do_with_driver.invokeStatic(driver.clj:106)
	at metabase.driver$do_with_driver.invoke(driver.clj:101)
	at metabase.query_processor.setup$do_with_driver73908__73909$fn__73910.invoke(setup.clj:165)
	at metabase.query_processor.setup$do_with_metadata_provider73899__73900$fn__73901$fn__73904.invoke(setup.clj:151)
	at metabase.query_processor.store$do_with_metadata_provider59866__59867.invokeStatic(store.clj:170)
	at metabase.query_processor.store$do_with_metadata_provider59866__59867.invoke(store.clj:150)
	at metabase.query_processor.store$do_with_metadata_provider59866__59867.invokeStatic(store.clj:159)
	at metabase.query_processor.store$do_with_metadata_provider59866__59867.invoke(store.clj:150)
	at metabase.query_processor.setup$do_with_metadata_provider73899__73900$fn__73901.invoke(setup.clj:150)
	at metabase.query_processor.setup$do_with_resolved_database73889__73890$fn__73891.invoke(setup.clj:128)
	at metabase.query_processor.setup$do_with_qp_setup73927__73928.invokeStatic(setup.clj:232)
	at metabase.query_processor.setup$do_with_qp_setup73927__73928.invoke(setup.clj:216)
	at metabase.query_processor$process_query78776__78777.invokeStatic(query_processor.clj:78)
	at metabase.query_processor$process_query78776__78777.invoke(query_processor.clj:71)
	at metabase.api.dataset$run_streaming_query102475__102478$fn__102482.invoke(dataset.clj:84)
	at metabase.query_processor.streaming$_streaming_response$fn__83328$fn__83329$fn__83330.invoke(streaming.clj:185)
	at metabase.query_processor.streaming$_streaming_response$fn__83328$fn__83329.invoke(streaming.clj:183)
	at metabase.query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:174)
	at metabase.query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:161)
	at metabase.query_processor.streaming$_streaming_response$fn__83328.invoke(streaming.clj:180)
	at clojure.lang.AFn.applyToHelper(AFn.java:156)
	at clojure.lang.AFn.applyTo(AFn.java:144)
	at clojure.core$apply.invokeStatic(core.clj:667)
	at clojure.core$with_bindings_STAR_.invokeStatic(core.clj:1990)
	at clojure.core$with_bindings_STAR_.doInvoke(core.clj:1990)
	at clojure.lang.RestFn.applyTo(RestFn.java:145)
	at clojure.core$apply.invokeStatic(core.clj:671)
	at clojure.core$bound_fn_STAR_$fn__5837.doInvoke(core.clj:2020)
	at clojure.lang.RestFn.invoke(RestFn.java:424)
	at metabase.async.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:78)
	at metabase.async.streaming_response$do_f_STAR_.invoke(streaming_response.clj:76)
	at metabase.async.streaming_response$do_f_async$task__53504.invoke(streaming_response.clj:93)
	at clojure.lang.AFn.run(AFn.java:22)
	at java.base/java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:539)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
